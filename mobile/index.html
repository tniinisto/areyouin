<!doctype html>
<html lang="en">

<head>
<meta charset="utf-8">

<!-- disable iPhone inital scale -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>R'YouIN</title>


<!--Jquery mobile 1.4.5-->
<!--<link rel="stylesheet" href="https://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.css" />-->
<link rel="stylesheet" href="js/jquery.mobile-1.4.5.min.css" />

<!--<script src="https://code.jquery.com/jquery-1.11.1.min.js"></script>-->
<script src="js/jquery-1.11.1.min.js"></script>

<!--<script src="https://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.js"></script>-->
<script src="js/jquery.mobile-1.4.5.min.js"></script>

<!-- main css -->
<link href="style.css" rel="stylesheet" type="text/css">

<!-- media queries css -->
<link href="media-queries.css" rel="stylesheet" type="text/css">

<!-- Scripts -->
<script type="text/javascript" charset="utf-8" src="main.js"> </script>
<script src="js/iscroll.js"></script>
<script type="text/javascript" src="../js/scrollintoview.js"></script>

<!--JQuery -->
<!--<script src="http://code.jquery.com/jquery-2.0.0.min.js"></script>-->
<script type="text/javascript" src="js/jquery.form.min.js"></script>
<script type="text/javascript" src="js/spin.min.js"></script>

<!--Snowing-->
<!--<script type="text/javascript" src="js/jquery.snow.js"></script>-->

<script>
    var scroll;
    //$("#chatdiv").on("show", function () {
    //    alert("#chatdiv is now shown");
    //    scroll.refresh();
    //});

	$(document).on("pageshow","#areyouin-chat-page",function(){
  		scroll.refresh();
	});

</script>

<!-- html5.js for IE less than 9 -->
<!--[if lt IE 9]>
	<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->

<!-- css3-mediaqueries.js for IE less than 9 -->
<!--[if lt IE 9]>
	<script src="http://css3-mediaqueries-js.googlecode.com/svn/trunk/css3-mediaqueries.js"></script>
<![endif]-->

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-50815012-2', 'auto');
  ga('send', 'pageview');

</script>

<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-180x180.png">
<link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
<link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="/manifest.json">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-TileImage" content="/mstile-144x144.png">
<meta name="theme-color" content="#ffffff">

</head>

<body>
    <div id="spinner_id"></div>

	<!-- Events -->
	 <div data-role="page" id="areyouin-events-page" data-theme="b" data-url="areyouin-events-page">
	    <div data-role="header" data-theme="b"  data-position="fixed" data-tap-toggle="false">	        
            <h1><span style="display: inline; font-size: 1.7em;">R'YouIN </span><img id="msg_icon1" class="msg_icon_style noshow" alt="New messages" src="../images/new_chat.png"></img></h1>
            <h1 id="userlogin1"> </h1>
	        <a href="#left-panel-events" data-theme="b" data-icon="bars" data-iconpos="notext" data-shadow="false" data-iconshadow="false" class="ui-icon-nodisc" >Open left panel</a>
	    </div>
	    
	    <div data-role="content">
    		<div id="event_content_id"> </div>
	    </div>
	    
        <!--Left menu panel-->
	    <div data-role="panel" id="left-panel-events" data-display="overlay" data-theme="b">
	        <p style="font-size: 22px; font-weight: 700; color:#ffd800;">Menu</p>

	        <a href="#areyouin-events-page" data-role="button" data-theme="b" data-icon="events" data-iconpos="" data-shadow="" data-iconshadow="" class="icon-events menu-layout"
               style="background-color: #2A2A2A; border-radius: 0; color: #FFF; text-shadow: none; height: 40px;">
                <div style="padding-top: 8px; font-size: 20px; font-weight: 400;">Events</div>
            </a>

	        <a href="#areyouin-chat-page" data-role="button" data-theme="b" data-icon="chat" data-iconpos="" data-shadow="" data-iconshadow="" class="icon-chat menu-layout" onclick="updateLastMsgTime();"
               style="background-color: #2A2A2A; border-radius: 0; color: #FFF; text-shadow: none; height: 40px;">
                <div style="padding-top: 8px; font-size: 20px; font-weight: 400;">Chat</div>
            </a>

            <a href="#" data-role="button" data-theme="b" data-icon="logout" data-iconpos="" data-shadow="" data-iconshadow="" class="icon-logout menu-layout" onclick="logout.php; toLoginPage();"
                style="background-color: #2A2A2A; border-radius: 0; color: #FFF; text-shadow: none; height: 40px;">
                <div style="padding-top: 8px; font-size: 20px; font-weight: 400;">Logout</div>
            </a>
	    </div>
    </div> 
    <!-- /Events -->   

    <!-- Chat -->
	 <div data-role="page" id="areyouin-chat-page" data-theme="b" data-url="areyouin-chat-page">
	    <div data-role="header" data-theme="b"  data-position="fixed" data-tap-toggle="false">	        
            <h1><span style="display: inline; font-size: 1.7em;">R'YouIN </span><img id="msg_icon2" class="msg_icon_style noshow" alt="New messages" src="../images/new_chat.png"></img></h1>
            <h1 id="userlogin2"> </h1>
	        <a href="#left-panel-chat" data-theme="b" data-icon="bars" data-iconpos="notext" data-shadow="false" data-iconshadow="false" class="ui-icon-nodisc" >Open left panel</a>
	    </div>
	    
	    <div data-role="content">           
            <a id="modal_comment" href="modal.html" data-role="button" data-rel="dialog" data-transition="flip" data-theme="b" style="margin-top: -5px;">New comment</a>
            <div id="chat_content_id"> </div>
	    </div>

        <!--Left menu panel-->
	    <div data-role="panel" id="left-panel-chat" data-display="overlay" data-theme="b">
	        <p style="font-size: 22px; font-weight: 700; color:#ffd800;">Menu</p>

	        <a href="#areyouin-events-page" data-role="button" data-theme="b" data-icon="events" data-iconpos="" data-shadow="" data-iconshadow="" class="icon-events menu-layout"
               style="background-color: #2A2A2A; border-radius: 0; color: #FFF; text-shadow: none; height: 40px;">
                <div style="padding-top: 8px; font-size: 20px; font-weight: 400;">Events</div>
            </a>

	        <a href="#areyouin-chat-page" data-role="button" data-theme="b" data-icon="chat" data-iconpos="" data-shadow="" data-iconshadow="" class="icon-chat menu-layout" onclick="updateLastMsgTime();"
               style="background-color: #2A2A2A; border-radius: 0; color: #FFF; text-shadow: none; height: 40px;">
                <div style="padding-top: 8px; font-size: 20px; font-weight: 400;">Chat</div>
            </a>

            <a href="#" data-role="button" data-theme="b" data-icon="logout" data-iconpos="" data-shadow="" data-iconshadow="" class="icon-logout menu-layout" onclick="logout.php; toLoginPage();"
                style="background-color: #2A2A2A; border-radius: 0; color: #FFF; text-shadow: none; height: 40px;">
                <div style="padding-top: 8px; font-size: 20px; font-weight: 400;">Logout</div>
            </a>
	    </div>
    </div> 
    <!-- /Chat -->  
	
<!-- scripts -->
<script>

    //Logout
    function logout() {
        $.get("logout.php");
    }

    //Document ready
    jQuery(document).ready(function () {
        
        //Winter season :)
        //$.fn.snow({ minSize: 5, maxSize: 50, newOn: 1000, flakeColor: '#FFFFFF' });

        //Init functions
        getLoginInformation();
        CheckForSession();

        //Spinner
        initSpinner();
        startSpinner();

        getEvents();
        //getPlayersInsert();
        //getAdminStatus();
        //getPlayerProfile();
        getChat();

        waitForChat();

        //Stop spinner after events have been load
        stopSpinner();

        //Events update
        setInterval(
            function () {
                getEvents();
            }, 240000
        ); //refreshes every 4 minutes

        //Main navigation///////////////////////////////////////
        $("#linkgames").click(function (event) {
            $("#main-nav").children().removeClass("current");
            $("#linkgames").addClass("current");
        });

        $("#linkprofile").click(function (event) {
            $("#main-nav").children().removeClass("current");
            $("#linkprofile").addClass("current");
        });

        $("#linkchat").click(function (event) {
            $("#main-nav").children().removeClass("current");
            $("#linkchat").addClass("current");
        });

        $("#linkadmin").click(function (event) {
            $("#main-nav").children().removeClass("current");
            $("#linkadmin").addClass("current");
        });
        //Main navigation///////////////////////////////////////


        //Admin navigation///////////////////////////////////////
        $("#link_admingame").click(function (event) {
            $("#admin-nav").children().removeClass("current2");
            $("#link_admingame").addClass("current2");
        });

        $("#link_adminsettings").click(function (event) {
            $("#admin-nav").children().removeClass("current2");
            $("#link_adminsettings").addClass("current2");
        });

        $("#link_adminmembers").click(function (event) {
            $("#admin-nav").children().removeClass("current2");
            $("#link_adminmembers").addClass("current2");
        });

        //Admin navigation///////////////////////////////////////

        //Profile navigation///////////////////////////////////////
        $("#link_profile_profile").click(function (event) {
            $("#profile-nav").children().removeClass("current2");
            $("#link_profile_profile").addClass("current2");
        });

        $("#link_profile_team").click(function (event) {
            $("#profile-nav").children().removeClass("current2");
            $("#link_profile_team").addClass("current2");
        });
        //Profile navigation///////////////////////////////////////


        //Image upload/////////////////////////////////////////////
        $('#progressbox').hide();

        var options = {
            target: '#output',   // target element(s) to be updated with server response 
            beforeSubmit: beforeSubmit,  // pre-submit callback 
            success: afterSuccess,  // post-submit callback 
            uploadProgress: OnProgress, //upload progress callback 
            resetForm: true        // reset the form after successful submit 
        };

        $('#MyUploadForm').submit(function () {
            //alert("ajax");
            $(this).ajaxSubmit(options);
            // always return false to prevent standard browser submit and page navigation 
            return false;
        });


        //function after succesful file upload (when server response)
        function afterSuccess() {
            $('#submit-btn').show(); //hide submit button
            $('#loading-img').hide(); //hide submit button
            $('#progressbox').delay(1000).fadeOut(); //hide progress bar

            //Update event list & admin content with the new picture
            getEvents();
            getPlayersInsert();
        }

        //function to check file size before uploading.
        function beforeSubmit() {
            //check whether browser fully supports all File API
            if (window.File && window.FileReader && window.FileList && window.Blob) {

                if (!$('#FileInput').val()) //check empty input filed
                {
                    $("#output").html("You must select a file for upload");
                    return false
                }

                var fsize = $('#FileInput')[0].files[0].size; //get file size
                var ftype = $('#FileInput')[0].files[0].type; // get file type


                //allow file types 
                switch (ftype) {
                    case 'image/png':
                    case 'image/gif':
                    case 'image/jpeg':
                    case 'image/JPG':
                    case 'image/pjpeg':
                    case 'text/plain':
                    case 'text/html':
                    case 'application/x-zip-compressed':
                    case 'application/pdf':
                    case 'application/msword':
                    case 'application/vnd.ms-excel':
                    case 'video/mp4':
                        break;
                    default:
                        $("#output").html("<b>" + ftype + "</b> Unsupported file type!");
                        return false
                }

                //Allowed file size is less than 5 MB (5048576)
                if (fsize > 2042880) {
                    $("#output").html("<b>" + bytesToSize(fsize) + "</b> Too big file! <br />File is too big, it should be less than 2 MB.");
                    return false
                }

                $('#submit-btn').hide(); //hide submit button
                $('#loading-img').show(); //hide submit button
                $("#output").html("");
            }
            else {
                //Output error to older unsupported browsers that doesn't support HTML5 File API
                $("#output").html("Please upgrade your browser, because your current browser lacks some new features we need!");
                return false;
            }
        }

        //progress bar function
        function OnProgress(event, position, total, percentComplete) {
            //Progress bar
            $('#progressbox').show();
            $('#progressbar').width(percentComplete + '%') //update progressbar percent complete
            $('#statustxt').html(percentComplete + '%'); //update status text
            if (percentComplete > 50) {
                $('#statustxt').css('color', '#000'); //change status text to white after 50%
            }
        }

        //function to format bites bit.ly/19yoIPO
        function bytesToSize(bytes) {
            var sizes = ['Bytes', 'KB', 'MB', 'GB', 'TB'];
            if (bytes == 0) return '0 Bytes';
            var i = parseInt(Math.floor(Math.log(bytes) / Math.log(1024)));
            return Math.round(bytes / Math.pow(1024, i), 2) + ' ' + sizes[i];
        }

    });


    //Main navigation - Content for the selected page///////////
    $("#main-nav").click(function () {
        //alert("Handler for .click() called.");
        //Games
        if ($("#linkgames").hasClass('current')) {
            $("#event_content_id").removeClass("noshow");
            $("#profile_content_id").addClass("noshow");
            $("#chat_content_id").addClass("noshow");
            $("#admin_content_id").addClass("noshow");
        }
        //Profile
        if ($("#linkprofile").hasClass('current')) {
            $("#event_content_id").addClass("noshow");
            $("#profile_content_id").removeClass("noshow");
            $("#chat_content_id").addClass("noshow");
            $("#admin_content_id").addClass("noshow");
        }

        //Chat
        if ($("#linkchat").hasClass('current')) {
            $("#event_content_id").addClass("noshow");
            $("#profile_content_id").addClass("noshow");
            $("#chat_content_id").removeClass("noshow");
            $("#admin_content_id").addClass("noshow");
        }

        //Admin
        if ($("#linkadmin").hasClass('current')) {
            $("#event_content_id").addClass("noshow");
            $("#profile_content_id").addClass("noshow");
            $("#chat_content_id").addClass("noshow");
            $("#admin_content_id").removeClass("noshow");
        }
    });
    //Main navigation - Content for the selected page///////////

    //Admin navigation - Content for the selected page///////////
    function adminClick() {
        //alert("Handler for admin navigation .click() called.");
        //Games
        if ($("#link_admingame").hasClass('current2')) {
            $("#newgame_id").removeClass("noshow");
            $("#team_content_id").addClass("noshow");
            $("#member_content_id").addClass("noshow");         
        }

        if ($("#link_adminsettings").hasClass('current2')) {
            $("#newgame_id").addClass("noshow");
            $("#team_content_id").removeClass("noshow");
            $("#member_content_id").addClass("noshow");
        }

        if ($("#link_adminmembers").hasClass('current2')) {
            $("#newgame_id").addClass("noshow");
            $("#team_content_id").addClass("noshow");
            $("#member_content_id").removeClass("noshow");
        }
    };
    //Admin navigation - Content for the selected page///////////

    //Profile navigation - Content for the selected page///////////
    function profileClick() {
        //alert("Handler for admin navigation .click() called.");
        //Games
        if ($("#link_profile_profile").hasClass('current2')) {
            $("#profile_profile_content_id").removeClass("noshow");
            $("#profile_team_content_id").addClass("noshow");
        }

        if ($("#link_profile_team").hasClass('current2')) {
            $("#profile_profile_content_id").addClass("noshow");
            $("#profile_team_content_id").removeClass("noshow");
        }
    };
    //Profile navigation - Content for the selected page///////////

</script>
<!-- /scripts -->
    
<script src="json/playerinfo.js"></script>    			

</body>
</html>
